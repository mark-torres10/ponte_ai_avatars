(()=>{"use strict";const t={isActive:!1,pageInfo:null,avatarVisible:!1};function e(){const t=[],e=document.querySelector("h1");if(e){const n=e.textContent?.trim();if(n&&n.includes("@")){const e=n.split("@").map(t=>t.trim());if(2===e.length)return t.push(...e),t}}return[]}function n(){const t=[];return document.querySelectorAll('a[href*="/nba/team/_/name/"]').forEach(e=>{const n=e.textContent?.trim();n&&n.length>0&&n.length<50&&t.push(n)}),t.length>=2?t:[]}function o(){const t=[];return document.querySelectorAll('a[href*="/nba/team/_/name/"]').forEach(e=>{const n=e.textContent?.trim();n&&n.length>0&&n.length<50&&t.push(n)}),t.length>=2?t:[]}function r(t){return t.filter(t=>t.length>3&&t.length<50&&!t.includes("Regular Season")&&!t.includes("Game Information")&&!t.includes("Standings")&&!t.includes("NBA News")&&!t.includes("Series"))}function i(){if(t.isActive)return;const i=function(){const t=window.location.href;if(!/espn\.com\/nba\/boxscore\/_\/(gameId\/\d+)/.test(t))return null;const i=t.match(/gameId\/(\d+)/),a=i?i[1]:void 0,s=function(){const t=[e,n,o];for(const e of t)try{const t=e();if(t&&t.length>=2){const e=r(t);if(e.length>=2)return e}}catch(t){}return[]}(),c=function(t){try{const e=document.querySelector("h1");if(e){const n=e.textContent?.trim();if(n&&n.includes("@")){const e=n.split("@").map(t=>t.trim());if(2===e.length){const n=e[0],o=e[1];if(t.includes(n)&&t.includes(o))return{away:n,home:o}}}}const n=document.title.match(/(\w+)\s+(\d+)-(\d+)\s+(\w+)/);if(n){const e=n[1],o=n[4],r=t.find(t=>t.includes(e)||t.includes(e.charAt(0).toUpperCase()+e.slice(1))),i=t.find(t=>t.includes(o)||t.includes(o.charAt(0).toUpperCase()+o.slice(1)));if(r&&i)return{away:r,home:i}}if(t.length>=2)return{away:t[0],home:t[1]}}catch(t){}}(s),l=function(){const t=Array.from(document.querySelectorAll("h3")).find(t=>"Game Information"===t.textContent?.trim());if(t){let e=t.nextElementSibling;return e||(e=t.parentElement),e}return null}(),d=function(){try{const t=document.querySelectorAll('div[class*="score"], span[class*="score"]');for(const e of t){const t=e.textContent?.trim();if(t&&t.match(/^\d+$/)){const e=parseInt(t,10);isNaN(e)}}const e=document.querySelectorAll("tr");let n=null,o=null;for(const t of e){const e=t.querySelectorAll("td");if(e.length>0){const t=e[e.length-1],r=t.textContent?.trim();if(r&&r.match(/^\d+$/)){const t=parseInt(r,10);if(!isNaN(t)&&t>=0&&t<=200)if(null===n)n=t;else if(null===o){o=t;break}}}}if(null!==n&&null!==o)return{away:n,home:o};const r=document.title.match(/(\d+)-(\d+)/);if(r){const t=parseInt(r[1],10),e=parseInt(r[2],10);if(!isNaN(t)&&!isNaN(e))return{away:t,home:e}}}catch(t){}}(),m=function(){try{const t=document.querySelectorAll('div[class*="status"], span[class*="status"], div[class*="time"], span[class*="time"]');for(const e of t){const t=e.textContent?.trim();if(t&&t.match(/^(Final|Q\d+|OT|End|Start)/i))return{quarter:t,timeRemaining:"Final"===t||"End"===t?"0:00":""}}const e=document.querySelector("main")||document.body;if(e){const t=e.textContent?.match(/(Q\d+|OT|Final|End|Start)/i);if(t){const e=t[1];return{quarter:e,timeRemaining:"Final"===e||"End"===e?"0:00":""}}}if(document.title.includes("Final"))return{quarter:"Final",timeRemaining:"0:00"}}catch(t){}}(),u=function(){try{const t=document.querySelectorAll('div[class*="status"], span[class*="status"]');for(const e of t){const t=e.textContent?.trim();if(t&&t.match(/^(Final|Live|Q\d+|OT|End|Start)/i))return t}if(document.title.includes("Final"))return"Final";const e=document.querySelector("main")||document.body;if(e){const t=e.textContent?.match(/(Final|Live|Q\d+|OT|End|Start)/i);if(t)return t[1]}}catch(t){}}(),f=function(t){let e,n;try{if(t){const o=t.textContent||"",r=o.match(/([^,\n]+(?:Center|Arena|Stadium|Field|Coliseum))/i);r&&(e=r[1].trim());const i=o.match(/([A-Za-z\s]+,\s*[A-Z]{2})/);i&&(n=i[1].trim())}if(!e||!n){const t=document.querySelectorAll("li");for(const o of t){const t=o.textContent?.trim();t&&(!e&&(t.includes("Center")||t.includes("Arena")||t.includes("Stadium"))?e=t:!n&&t.includes(",")&&t.length<50&&!t.includes("Attendance")&&(n=t))}}if(!e||!n){const t=document.body.textContent||"";if(!e){const n=t.match(/(Wells Fargo Center|Madison Square Garden|Staples Center|Chase Center|American Airlines Center|TD Garden|Fiserv Forum|Rocket Mortgage FieldHouse|State Farm Arena|Capital One Arena)/);n&&(e=n[1])}if(!n){const e=t.match(/([A-Za-z\s]+,\s*[A-Z]{2})/);e&&(n=e[1].trim())}}}catch(t){}return{venue:e,location:n}}(l),p=function(t){const e={},n=document.title.match(/(\w+ \d+), (\d{4})/);if(n&&(e.date=`${n[1]}, ${n[2]}`),t){const n=t.textContent||"",o=n.match(/Attendance:\s*([^,\n]+)/i);if(o&&(e.attendance=o[1].trim()),!e.date){const t=n.match(/(\w+ \d+), (\d{4})/);t&&(e.date=`${t[1]}, ${t[2]}`)}}return e}(l);return{isBoxscore:!0,pageType:"nba-boxscore",gameId:a,teamNames:s.length>0?s:void 0,scores:d,gameTime:m,gameStatus:u,venue:f.venue,location:f.location,metadata:p,extractionMethod:"primary",attemptedStrategies:["primary","fallback-css","fallback-text","fallback-content"],homeTeam:c?.home,awayTeam:c?.away,url:t}}();if(!i)return;t.pageInfo=i,t.isActive=!0,console.log("AI Avatar: ESPN NBA boxscore page detected:",i);const a=function(){const t=document.createElement("div");t.id="ai-avatar-placeholder",t.style.cssText="\n    position: fixed !important;\n    top: 20px !important;\n    right: 20px !important;\n    width: 80px !important;\n    height: 80px !important;\n    border-radius: 50% !important;\n    z-index: 2147483647 !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    box-shadow: 0 8px 24px rgba(0,0,0,0.4) !important;\n    cursor: pointer !important;\n    transition: transform 0.2s ease !important;\n    pointer-events: auto !important;\n    transform: translateZ(0) !important;\n    overflow: hidden !important;\n    border: 3px solid white !important;\n  ";const e=document.createElement("img");return e.src=chrome.runtime.getURL("parker-avatar-80x80.png"),e.style.cssText="\n    width: 100% !important;\n    height: 100% !important;\n    object-fit: cover !important;\n    border-radius: 50% !important;\n  ",t.appendChild(e),t.addEventListener("mouseenter",()=>{t.style.transform="scale(1.1)"}),t.addEventListener("mouseleave",()=>{t.style.transform="scale(1)"}),t.addEventListener("click",()=>{console.log("Avatar clicked - future functionality will be added")}),t}();document.body.appendChild(a),a.style.setProperty("position","fixed","important"),a.style.setProperty("z-index","2147483647","important"),a.style.setProperty("top","20px","important"),a.style.setProperty("right","20px","important"),a.classList.add("ai-avatar-extension"),t.avatarVisible=!0,chrome.runtime.sendMessage({type:"AVATAR_ACTIVATE",payload:i})}chrome.runtime.onMessage.addListener((e,n,o)=>{"PAGE_DETECTED"===e.type&&(t.isActive||i()),o({success:!0})}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i();let a=window.location.href;function s(){const e=document.getElementById("ai-avatar-placeholder");e&&t.avatarVisible&&(e.style.setProperty("position","fixed","important"),e.style.setProperty("z-index","2147483647","important"),e.style.setProperty("top","20px","important"),e.style.setProperty("right","20px","important"),e.style.setProperty("display","flex","important"))}new MutationObserver(()=>{if(window.location.href!==a){a=window.location.href,t.isActive=!1,t.avatarVisible=!1;const e=document.getElementById("ai-avatar-placeholder");e&&e.remove(),setTimeout(i,100)}}).observe(document.body,{childList:!0,subtree:!0}),window.addEventListener("scroll",s),window.addEventListener("resize",s),window.addEventListener("load",s),setInterval(s,2e3)})();